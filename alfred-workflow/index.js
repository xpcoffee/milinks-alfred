var h=Object.create;var l=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var G=(t,n)=>{for(var e in n)l(t,e,{get:n[e],enumerable:!0})},p=(t,n,e,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of N(n))!O.call(t,r)&&r!==e&&l(t,r,{get:()=>n[r],enumerable:!(i=I(n,r))||i.enumerable});return t};var L=(t,n,e)=>(e=t!=null?h(A(t)):{},p(n||!t||!t.__esModule?l(e,"default",{value:t,enumerable:!0}):e,t)),y=t=>p(l({},"__esModule",{value:!0}),t);var w={};G(w,{script:()=>M});module.exports=y(w);var a=L(require("fuzzy-search")),f=require("fs"),m=L(require("path")),k=require("os");function M(){let t=!!process.env.MILINKS_SEARCH_ALL,n=process.env.MILINKS_FILE_PATH,e=process.env.MILINKS_GROUP,[i,r,o]=process.argv,c=e?_(e):b(n);function s(){let u=J(c),S=x(u,o);return U(S)}function g(){let{items:u}=z(c);return{items:E(u,o)}}let F=t?s():g();console.log(JSON.stringify(F))}function _(t){try{return JSON.parse(t)}catch(n){console.error("Unable to parse link group into JSON: "+n),process.exit(1)}}function b(t){t||(console.error("No MiLinks file path."),process.exit(1));try{let n=(0,f.readFileSync)(v(t),"utf-8");return JSON.parse(n)}catch(n){console.error("Unable to parse link file into JSON: "+n),process.exit(1)}}function v(t){return t[0]==="~"?m.default.join((0,k.homedir)(),t.slice(1)):t}function z(t){return{items:t.items.map(e=>"items"in e?{uid:Date.now().toString(),title:e.name??"Unnamed group",arg:"group",variables:{MILINKS_GROUP:JSON.stringify(e)}}:d({...e,groupName:t.name}))}}function J(t){let n=[];function e(i,r,o){if("items"in r){let c=[o,r.name].filter(s=>s!==void 0&&(s==null?void 0:s.length)).join("/");r.items.forEach(s=>e(i,s,c))}else i.push({...r,groupName:o})}return e(n,t),n}function x(t,n){if(!n)return t;let e=n.split(" "),i=t;return e.forEach(r=>{i=new a.default(i,["description","title","groupName"]).search(r)}),i}function E(t,n){if(!n)return t;let e=n.split(" "),i=t;return e.forEach(r=>{i=new a.default(i,["title"]).search(r)}),i}function U(t){return{items:t.map(d)}}function d(t){let n=[t.groupName,t.description,t.url].filter(e=>e!==void 0&&(e==null?void 0:e.length)).join(" | ");return{uid:t.title,title:t.title,subtitle:n,arg:t.url,variables:{url:t.url}}}0&&(module.exports={script});
